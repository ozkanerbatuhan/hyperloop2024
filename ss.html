<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Motion Data Visualization</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      .chart-container {
        width: 80%;
        margin: 20px auto;
      }
    </style>
  </head>
  <body>

    <div class="charts-grid">
        <div class="chart">
          <h3>Hız</h3>
          <div id="velocity-chart"><canvas id="velocityChart"></canvas></div>
        </div>
        <div class="chart">
          <h3>Konum</h3>
          <div id="position-chart"><canvas id="positionChart"></canvas></div>
        </div>
        <div class="chart">
          <h3>Yönelim</h3>
          <div id="orientation-chart"><canvas id="orientationChart"></canvas></div>
        </div>
        <div class="chart">
          <h3>İvme</h3>
          <div id="acceleration-chart"><canvas id="accelerationChart"></canvas></div>
        </div>
      </div>
      
      <style>
        .charts-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(700px, 1fr));
          gap: 20px;
          padding: 20px;
        }
        .chart {
          background-color: #f5f5f5;
          border-radius: 10px;
          padding: 15px;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .chart h3 {
          margin-top: 0;
          margin-bottom: 10px;
          font-size: 18px;
          color: #333;
        }
      </style>

    <script>
      class MotionCalculator {
        constructor() {
          this.velocity = { x: 0, y: 0, z: 0 };
          this.position = { x: 0, y: 0, z: 0 };
          this.orientation = { pitch: 0, yaw: 0, roll: 0 };
          this.lastUpdateTime = Date.now();
          this.gravity = 9.81;
          this.alpha = 0.8; // Low-pass filter coefficient
          this.gyroError = { x: 0.56, y: -2, z: 0.79 }; // From Arduino code
          this.accError = { x: 0.58, y: -1.58 }; // From Arduino code
          this.lastGyro = { x: 0, y: 0, z: 0 };
          this.gyroAngle = { x: 0, y: 0 };
          this.initialized = false;
          this.stationaryThreshold = 0.015;
        }

        update(acceleration, gyro) {
          const currentTime = Date.now();
          const elapsedTime = (currentTime - this.lastUpdateTime) / 1000; // Time in seconds

          if (!this.initialized) {
            this.initializeStationary(acceleration, gyro);
            this.initialized = true;
            return this.getCurrentState();
          }

          // ... (keep existing angle calculations)

          // Update velocity and position using RK4
          const initialState = {
            position: { ...this.position },
            velocity: { ...this.velocity },
          };

          const finalState = this.rk4(initialState, acceleration, elapsedTime);

          this.position = finalState.position;
          this.velocity = finalState.velocity;

          this.lastUpdateTime = currentTime;
          this.lastGyro = gyro;

          return this.getCurrentState(elapsedTime);
        }

        rk4(initialState, acceleration, dt) {
          const k1 = this.derivative(initialState, acceleration);
          const k2 = this.derivative(
            this.getMiddleState(initialState, k1, dt / 2),
            acceleration
          );
          const k3 = this.derivative(
            this.getMiddleState(initialState, k2, dt / 2),
            acceleration
          );
          const k4 = this.derivative(
            this.getMiddleState(initialState, k3, dt),
            acceleration
          );

          return {
            position: {
              x:
                initialState.position.x +
                (dt / 6) * (k1.dx + 2 * k2.dx + 2 * k3.dx + k4.dx),
              y:
                initialState.position.y +
                (dt / 6) * (k1.dy + 2 * k2.dy + 2 * k3.dy + k4.dy),
              z:
                initialState.position.z +
                (dt / 6) * (k1.dz + 2 * k2.dz + 2 * k3.dz + k4.dz),
            },
            velocity: {
              x:
                initialState.velocity.x +
                (dt / 6) * (k1.dvx + 2 * k2.dvx + 2 * k3.dvx + k4.dvx),
              y:
                initialState.velocity.y +
                (dt / 6) * (k1.dvy + 2 * k2.dvy + 2 * k3.dvy + k4.dvy),
              z:
                initialState.velocity.z +
                (dt / 6) * (k1.dvz + 2 * k2.dvz + 2 * k3.dvz + k4.dvz),
            },
          };
        }

        derivative(state, acceleration) {
          const filteredAcc = this.lowPassFilter(
            this.removeGravity(acceleration)
          );
          return {
            dx: state.velocity.x,
            dy: state.velocity.y,
            dz: state.velocity.z,
            dvx: filteredAcc.x,
            dvy: filteredAcc.y,
            dvz: filteredAcc.z,
          };
        }

        getMiddleState(initialState, k, dt) {
          return {
            position: {
              x: initialState.position.x + k.dx * dt,
              y: initialState.position.y + k.dy * dt,
              z: initialState.position.z + k.dz * dt,
            },
            velocity: {
              x: initialState.velocity.x + k.dvx * dt,
              y: initialState.velocity.y + k.dvy * dt,
              z: initialState.velocity.z + k.dvz * dt,
            },
          };
        }

        initializeStationary(acceleration, gyro) {
          this.filteredAcc = { x: 0, y: 0, z: 0 };
          this.lastGyro = gyro;
        }

        removeGravity(acceleration) {
          return {
            x: acceleration.x - this.gravity,
            y: acceleration.y,
            z: acceleration.z,
          };
        }

        lowPassFilter(acceleration) {
          this.filteredAcc.x =
            this.alpha * this.filteredAcc.x + (1 - this.alpha) * acceleration.x;
          this.filteredAcc.y =
            this.alpha * this.filteredAcc.y + (1 - this.alpha) * acceleration.y;
          this.filteredAcc.z =
            this.alpha * this.filteredAcc.z + (1 - this.alpha) * acceleration.z;
          return this.filteredAcc;
        }

        correctGyro(gyro) {
          const gyroDiff = {
            x: gyro.x - this.lastGyro.x,
            y: gyro.y - this.lastGyro.y,
            z: gyro.z - this.lastGyro.z,
          };

          const errorWeight = 0.95;
          this.gyroError.x =
            errorWeight * this.gyroError.x + (1 - errorWeight) * gyroDiff.x;
          this.gyroError.y =
            errorWeight * this.gyroError.y + (1 - errorWeight) * gyroDiff.y;
          this.gyroError.z =
            errorWeight * this.gyroError.z + (1 - errorWeight) * gyroDiff.z;

          return {
            x: gyro.x - this.gyroError.x,
            y: gyro.y - this.gyroError.y,
            z: gyro.z - this.gyroError.z,
          };
        }

        updateOrientation(acceleration, gyro, timeStep) {
          const accelPitch = Math.atan2(
            -acceleration.x,
            Math.sqrt(
              acceleration.y * acceleration.y + acceleration.z * acceleration.z
            )
          );
          const accelRoll = Math.atan2(acceleration.y, acceleration.z);

          const gyroWeight = 0.95;
          this.orientation.pitch =
            gyroWeight * (this.orientation.pitch + gyro.x * timeStep) +
            (1 - gyroWeight) * ((accelPitch * 180) / Math.PI);
          this.orientation.roll =
            gyroWeight * (this.orientation.roll + gyro.y * timeStep) +
            (1 - gyroWeight) * ((accelRoll * 180) / Math.PI);
          this.orientation.yaw += gyro.z * timeStep;

          this.orientation.pitch = this.normalizeAngle(this.orientation.pitch);
          this.orientation.roll = this.normalizeAngle(this.orientation.roll);
          this.orientation.yaw = this.normalizeAngle(this.orientation.yaw);
        }

        normalizeAngle(angle) {
          while (angle > 180) angle -= 360;
          while (angle < -180) angle += 360;
          return angle;
        }

        getCurrentState(timeStep) {
          return {
            velocity: { ...this.velocity },
            position: { ...this.position },
            orientation: { ...this.orientation },
            acceleration: { ...this.filteredAcc },
            timeStep: timeStep,
          };
        }
      }

      // Simüle edilmiş veri (gerçek uygulamada bu kısmı değiştirin)
      const data = [
        {
          accelerometer: {
            x: 9.842563024902343,
            y: -0.062249243164062495,
            z: 0.3495534423828125,
          },
          gyroscope: {
            x: -0.040768759626737774,
            y: -0.0005329249624410166,
            z: -0.004263399699528133,
          },
          temperature: 24.24764705882353,
          time: 1723317281.65731,
        },
        {
          accelerometer: {
            x: 9.849745629882811,
            y: -0.11013327636718749,
            z: 0.22266075439453123,
          },
          gyroscope: {
            x: -0.03970290970185574,
            y: 0.0005329249624410166,
            z: -0.0018652373685435584,
          },
          temperature: 24.15352941176471,
          time: 1723317288.1943116,
        },
        {
          accelerometer: {
            x: 9.89523546142578,
            y: -0.07900865478515624,
            z: 0.2920926025390625,
          },
          gyroscope: {
            x: -0.041301684589178794,
            y: 0.002398162330984575,
            z: -0.004263399699528133,
          },
          temperature: 24.059411764705885,
          time: 1723317294.7544045,
        },
        {
          accelerometer: {
            x: 9.9215716796875,
            y: -0.033518823242187495,
            z: 0.28969840087890625,
          },
          gyroscope: {
            x: -0.03956967846124549,
            y: 0.001732006127933304,
            z: -0.006128637068071691,
          },
          temperature: 24.24764705882353,
          time: 1723317295.554521,
        },
        {
          accelerometer: {
            x: 9.883264453125,
            y: -0.07900865478515624,
            z: 0.27293898925781246,
          },
          gyroscope: {
            x: -0.041301684589178794,
            y: 0.0018652373685435584,
            z: -0.00479632466196915,
          },
          temperature: 24.15352941176471,
          time: 1723317296.3502192,
        },
        {
          accelerometer: {
            x: 9.823409411621093,
            y: -0.0909796630859375,
            z: 0.277727392578125,
          },
          gyroscope: {
            x: -0.040768759626737774,
            y: 0.0009326186842717792,
            z: -0.007993874436615249,
          },
          temperature: 24.15352941176471,
          time: 1723317297.1345696,
        },
        {
          accelerometer: {
            x: 9.86411083984375,
            y: 0.02154781494140625,
            z: 0.2442085693359375,
          },
          gyroscope: {
            x: -0.04210107203284032,
            y: 0.0021316998497640663,
            z: -0.004263399699528133,
          },
          temperature: 24.15352941176471,
          time: 1723317297.9495242,
        },
        {
          accelerometer: {
            x: 9.852139831542969,
            y: -0.143652099609375,
            z: 0.33039982910156246,
          },
          gyroscope: {
            x: -0.041434915829789046,
            y: 0.0003996937218307625,
            z: -0.005329249624410167,
          },
          temperature: 24.15352941176471,
          time: 1723317298.7342887,
        },
        {
          accelerometer: {
            x: 9.871293444824218,
            y: 0.00239420166015625,
            z: 0.33039982910156246,
          },
          gyroscope: {
            x: -0.0430336907171121,
            y: 0.003464012255866608,
            z: -0.007727411955394742,
          },
          temperature: 24.15352941176471,
          time: 1723317299.517614,
        },
        {
          accelerometer: {
            x: 9.854534033203125,
            y: -0.040701428222656245,
            z: 0.34237083740234375,
          },
          gyroscope: {
            x: -0.03863705977697371,
            y: 0.0014655436467127959,
            z: -0.0063950995492922,
          },
          temperature: 24.15352941176471,
          time: 1723317300.295504,
        },
        {
          accelerometer: {
            x: 9.785102185058593,
            y: -0.0718260498046875,
            z: 0.36391865234375,
          },
          gyroscope: {
            x: -0.040901990867348026,
            y: 0.0014655436467127959,
            z: -0.006661562030512709,
          },
          temperature: 24.24764705882353,
          time: 1723317301.0865216,
        },
        {
          accelerometer: {
            x: 9.866505041503906,
            y: -0.05027823486328125,
            z: 0.2753331909179687,
          },
          gyroscope: {
            x: -0.0401026034236865,
            y: 0.0005329249624410166,
            z: -0.0074609494741742334,
          },
          temperature: 24.106470588235297,
          time: 1723317301.8689797,
        },
        {
          accelerometer: {
            x: 9.828197814941406,
            y: -0.11013327636718749,
            z: 0.22026655273437498,
          },
          gyroscope: {
            x: -0.0383705972957532,
            y: 0.0006661562030512709,
            z: -0.007194486992953725,
          },
          temperature: 24.24764705882353,
          time: 1723317302.661536,
        },
        {
          accelerometer: {
            x: 9.823409411621093,
            y: -0.07900865478515624,
            z: 0.28730419921875,
          },
          gyroscope: {
            x: -0.0401026034236865,
            y: -0.0002664624812205083,
            z: -0.008793261880276773,
          },
          temperature: 24.15352941176471,
          time: 1723317303.4658463,
        },
        {
          accelerometer: {
            x: 9.91438907470703,
            y: -0.04548983154296875,
            z: 0.2920926025390625,
          },
          gyroscope: {
            x: -0.041168453348568536,
            y: 0.0013323124061025418,
            z: -0.0058621745868511835,
          },
          temperature: 24.20058823529412,
          time: 1723317304.2625334,
        },
        {
          accelerometer: {
            x: 9.900023864746093,
            y: -0.03591302490234375,
            z: 0.3184288208007812,
          },
          gyroscope: {
            x: -0.041434915829789046,
            y: 0.001732006127933304,
            z: -0.0039969372183076245,
          },
          temperature: 24.15352941176471,
          time: 1723317305.04125,
        },
        {
          accelerometer: {
            x: 9.86411083984375,
            y: -0.11013327636718749,
            z: 0.3112462158203125,
          },
          gyroscope: {
            x: -0.03983614094246599,
            y: 0.0019984686091538122,
            z: -0.006128637068071691,
          },
          temperature: 24.15352941176471,
          time: 1723317305.8403275,
        },
        {
          accelerometer: {
            x: 9.859322436523437,
            y: -0.040701428222656245,
            z: 0.35673604736328124,
          },
          gyroscope: {
            x: -0.039969372183076245,
            y: 0.002264931090374321,
            z: -0.005329249624410167,
          },
          temperature: 24.20058823529412,
          time: 1723317306.6520867,
        },
        {
          accelerometer: {
            x: 9.854534033203125,
            y: -0.05746083984375,
            z: 0.3280056274414062,
          },
          gyroscope: {
            x: -0.03903675349880447,
            y: 0.0006661562030512709,
            z: -0.0074609494741742334,
          },
          temperature: 24.15352941176471,
          time: 1723317307.4647982,
        },
        {
          accelerometer: {
            x: 9.871293444824218,
            y: -0.0383072265625,
            z: 0.2537853759765625,
          },
          gyroscope: {
            x: -0.04170137831100955,
            y: 0.002398162330984575,
            z: -0.0063950995492922,
          },
          temperature: 24.20058823529412,
          time: 1723317308.235575,
        },
        {
          accelerometer: {
            x: 9.87608184814453,
            y: -0.055066638183593745,
            z: 0.316034619140625,
          },
          gyroscope: {
            x: -0.03970290970185574,
            y: 0.0013323124061025418,
            z: -0.005062787143189658,
          },
          temperature: 24.341764705882355,
          time: 1723317309.0228136,
        },
        {
          accelerometer: {
            x: 9.890447058105469,
            y: -0.08858546142578125,
            z: 0.36631285400390623,
          },
          gyroscope: {
            x: -0.036105666205378875,
            y: 0.000799387443661525,
            z: -0.007727411955394742,
          },
          temperature: 24.15352941176471,
          time: 1723317309.8162494,
        },
        {
          accelerometer: {
            x: 9.93354268798828,
            y: -0.047884033203124995,
            z: 0.3806780639648437,
          },
          gyroscope: {
            x: -0.041301684589178794,
            y: 0.002531393571594829,
            z: -0.00479632466196915,
          },
          temperature: 24.24764705882353,
          time: 1723317310.6095872,
        },
        {
          accelerometer: {
            x: 9.871293444824218,
            y: -0.1005564697265625,
            z: 0.2753331909179687,
          },
          gyroscope: {
            x: -0.03810413481453269,
            y: 0.002264931090374321,
            z: -0.006928024511733216,
          },
          temperature: 24.15352941176471,
          time: 1723317311.4210706,
        },
        {
          accelerometer: {
            x: 9.9215716796875,
            y: -0.028730419921875,
            z: 0.3184288208007812,
          },
          gyroscope: {
            x: -0.04210107203284032,
            y: -0.0003996937218307625,
            z: -0.0063950995492922,
          },
          temperature: 24.24764705882353,
          time: 1723317312.2017574,
        },
        {
          accelerometer: {
            x: 9.873687646484374,
            y: -0.13407529296874998,
            z: 0.28490999755859375,
          },
          gyroscope: {
            x: -0.03850382853636345,
            y: 0.0019984686091538122,
            z: -0.007194486992953725,
          },
          temperature: 24.15352941176471,
          time: 1723317312.9919605,
        },
        {
          accelerometer: {
            x: 9.962273107910155,
            y: -0.11013327636718749,
            z: 0.30406361083984373,
          },
          gyroscope: {
            x: -0.04036906590490701,
            y: 0.0021316998497640663,
            z: -0.00479632466196915,
          },
          temperature: 24.24764705882353,
          time: 1723317313.7613058,
        },
        {
          accelerometer: {
            x: 9.835380419921874,
            y: -0.023942016601562498,
            z: 0.4285620971679687,
          },
          gyroscope: {
            x: -0.040502297145517265,
            y: 0.002797856052815337,
            z: -0.007194486992953725,
          },
          temperature: 24.24764705882353,
          time: 1723317314.5622938,
        },
        {
          accelerometer: {
            x: 9.907206469726562,
            y: -0.0526724365234375,
            z: 0.3136404174804687,
          },
          gyroscope: {
            x: -0.040768759626737774,
            y: 0.0026646248122050836,
            z: -0.0063950995492922,
          },
          temperature: 24.24764705882353,
          time: 1723317315.3682978,
        },
        {
          accelerometer: {
            x: 9.880870251464843,
            y: -0.09576806640624999,
            z: 0.33039982910156246,
          },
          gyroscope: {
            x: -0.04316692195772235,
            y: -0.0002664624812205083,
            z: -0.006128637068071691,
          },
          temperature: 24.24764705882353,
          time: 1723317316.1518042,
        },
        {
          accelerometer: {
            x: 9.861716638183593,
            y: -0.11013327636718749,
            z: 0.2609679809570312,
          },
          gyroscope: {
            x: -0.03823736605514295,
            y: 0.0021316998497640663,
            z: -0.007194486992953725,
          },
          temperature: 24.24764705882353,
          time: 1723317316.96256,
        },
        {
          accelerometer: {
            x: 9.86411083984375,
            y: -0.09816226806640624,
            z: 0.277727392578125,
          },
          gyroscope: {
            x: -0.03797090357392244,
            y: 0.0019984686091538122,
            z: -0.006661562030512709,
          },
          temperature: 24.20058823529412,
          time: 1723317317.748992,
        },
        {
          accelerometer: {
            x: 9.866505041503906,
            y: -0.06464344482421874,
            z: 0.2825157958984375,
          },
          gyroscope: {
            x: -0.04063552838612752,
            y: -0.0009326186842717792,
            z: -0.00985911180515881,
          },
          temperature: 24.15352941176471,
          time: 1723317318.5304136,
        },
        {
          accelerometer: {
            x: 9.911994873046874,
            y: -0.0383072265625,
            z: 0.3232172241210937,
          },
          gyroscope: {
            x: -0.03863705977697371,
            y: 0.0002664624812205083,
            z: -0.004529862180748642,
          },
          temperature: 24.15352941176471,
          time: 1723317319.3193069,
        },
        {
          accelerometer: {
            x: 9.871293444824218,
            y: -0.06943184814453125,
            z: 0.3184288208007812,
          },
          gyroscope: {
            x: -0.03916998473941472,
            y: 0.0009326186842717792,
            z: -0.000799387443661525,
          },
          temperature: 24.106470588235297,
          time: 1723317320.0939448,
        },
        {
          accelerometer: {
            x: 9.897629663085937,
            y: -0.04548983154296875,
            z: 0.3950432739257812,
          },
          gyroscope: {
            x: -0.037837672333312186,
            y: 0.000799387443661525,
            z: -0.007993874436615249,
          },
          temperature: 24.059411764705885,
          time: 1723317320.8910093,
        },
        {
          accelerometer: {
            x: 9.854534033203125,
            y: -0.09337386474609374,
            z: 0.20350714111328125,
          },
          gyroscope: {
            x: -0.03903675349880447,
            y: 0.0006661562030512709,
            z: -0.005329249624410167,
          },
          temperature: 24.20058823529412,
          time: 1723317321.678923,
        },
        {
          accelerometer: {
            x: 9.885658654785155,
            y: -0.02633621826171875,
            z: 0.2154781494140625,
          },
          gyroscope: {
            x: -0.041301684589178794,
            y: -0.00013323124061025415,
            z: -0.0031975497746461,
          },
          temperature: 24.15352941176471,
          time: 1723317322.479193,
        },
        {
          accelerometer: {
            x: 9.852139831542969,
            y: -0.076614453125,
            z: 0.34237083740234375,
          },
          gyroscope: {
            x: -0.03757120985209167,
            y: 0.004130168458917879,
            z: -0.008260336917835759,
          },
          temperature: 24.24764705882353,
          time: 1723317323.2716017,
        },
        {
          accelerometer: {
            x: 9.919177478027343,
            y: -0.06703764648437499,
            z: 0.34237083740234375,
          },
          gyroscope: {
            x: -0.03823736605514295,
            y: 0.0014655436467127959,
            z: -0.0063950995492922,
          },
          temperature: 24.15352941176471,
          time: 1723317324.052476,
        },
        {
          accelerometer: {
            x: 9.890447058105469,
            y: -0.016759411621093748,
            z: 0.316034619140625,
          },
          gyroscope: {
            x: -0.040901990867348026,
            y: 0.002398162330984575,
            z: -0.006928024511733216,
          },
          temperature: 24.20058823529412,
          time: 1723317324.832863,
        },
        {
          accelerometer: {
            x: 9.847351428222655,
            y: -0.033518823242187495,
            z: 0.26336218261718747,
          },
          gyroscope: {
            x: -0.03930321598002497,
            y: -0.002531393571594829,
            z: -0.007194486992953725,
          },
          temperature: 24.24764705882353,
          time: 1723317325.6455822,
        },
        {
          accelerometer: {
            x: 9.878476049804688,
            y: -0.028730419921875,
            z: 0.2920926025390625,
          },
          gyroscope: {
            x: -0.03903675349880447,
            y: 0.002531393571594829,
            z: -0.006128637068071691,
          },
          temperature: 24.24764705882353,
          time: 1723317326.4481378,
        },
        {
          accelerometer: {
            x: 9.81862100830078,
            y: -0.11731588134765625,
            z: 0.3854664672851562,
          },
          gyroscope: {
            x: -0.041434915829789046,
            y: 0.003464012255866608,
            z: -0.0031975497746461,
          },
          temperature: 24.15352941176471,
          time: 1723317327.2464697,
        },
        {
          accelerometer: {
            x: 9.86411083984375,
            y: -0.040701428222656245,
            z: 0.28012159423828126,
          },
          gyroscope: {
            x: -0.040502297145517265,
            y: 0.0006661562030512709,
            z: -0.0026646248122050836,
          },
          temperature: 24.059411764705885,
          time: 1723317328.0314872,
        },
        {
          accelerometer: {
            x: 9.871293444824218,
            y: -0.086191259765625,
            z: 0.24181436767578124,
          },
          gyroscope: {
            x: -0.03823736605514295,
            y: 0.0010658499248820332,
            z: -0.003464012255866608,
          },
          temperature: 24.20058823529412,
          time: 1723317328.8492184,
        },
        {
          accelerometer: {
            x: 9.832986218261718,
            y: -0.0909796630859375,
            z: 0.40222587890625,
          },
          gyroscope: {
            x: -0.041301684589178794,
            y: -0.0005329249624410166,
            z: -0.003464012255866608,
          },
          temperature: 24.20058823529412,
          time: 1723317329.6333284,
        },
        {
          accelerometer: {
            x: 9.8449572265625,
            y: -0.05027823486328125,
            z: 0.354341845703125,
          },
          gyroscope: {
            x: -0.040901990867348026,
            y: 0.0005329249624410166,
            z: -0.005329249624410167,
          },
          temperature: 24.24764705882353,
          time: 1723317330.4088295,
        },
        {
          accelerometer: {
            x: 9.871293444824218,
            y: -0.09576806640624999,
            z: 0.28730419921875,
          },
          gyroscope: {
            x: -0.041168453348568536,
            y: 0.002531393571594829,
            z: -0.008260336917835759,
          },
          temperature: 24.106470588235297,
          time: 1723317331.183862,
        },
        {
          accelerometer: {
            x: 9.86411083984375,
            y: -0.05027823486328125,
            z: 0.2753331909179687,
          },
          gyroscope: {
            x: -0.03850382853636345,
            y: -0.0005329249624410166,
            z: -0.004529862180748642,
          },
          temperature: 24.24764705882353,
          time: 1723317331.9879737,
        },
        {
          accelerometer: {
            x: 9.86411083984375,
            y: -0.00718260498046875,
            z: 0.229843359375,
          },
          gyroscope: {
            x: -0.03943644722063524,
            y: 0.0030643185340358454,
            z: -0.0058621745868511835,
          },
          temperature: 24.15352941176471,
          time: 1723317332.7745152,
        },
        {
          accelerometer: {
            x: 9.821015209960937,
            y: -0.047884033203124995,
            z: 0.3758896606445312,
          },
          gyroscope: {
            x: -0.040901990867348026,
            y: 0.0019984686091538122,
            z: -0.005062787143189658,
          },
          temperature: 24.20058823529412,
          time: 1723317333.5612347,
        },
        {
          accelerometer: {
            x: 9.90241806640625,
            y: 0.01915361328125,
            z: 0.24899697265624998,
          },
          gyroscope: {
            x: -0.03890352225819422,
            y: 0.0005329249624410166,
            z: -0.005595712105630674,
          },
          temperature: 24.106470588235297,
          time: 1723317334.355847,
        },
        {
          accelerometer: {
            x: 9.804255798339844,
            y: -0.08858546142578125,
            z: 0.33758243408203126,
          },
          gyroscope: {
            x: -0.037837672333312186,
            y: 0.0031975497746461,
            z: -0.0037304747370871167,
          },
          temperature: 24.106470588235297,
          time: 1723317335.1407382,
        },
        {
          accelerometer: {
            x: 9.86411083984375,
            y: -0.06943184814453125,
            z: 0.30885201416015623,
          },
          gyroscope: {
            x: -0.03823736605514295,
            y: 0,
            z: -0.004529862180748642,
          },
          temperature: 24.294705882352943,
          time: 1723317335.9253798,
        },
        {
          accelerometer: {
            x: 9.880870251464843,
            y: -0.03591302490234375,
            z: 0.277727392578125,
          },
          gyroscope: {
            x: -0.04023583466429676,
            y: 0.0031975497746461,
            z: -0.006661562030512709,
          },
          temperature: 24.106470588235297,
          time: 1723317336.7201693,
        },
        {
          accelerometer: {
            x: 9.849745629882811,
            y: -0.047884033203124995,
            z: 0.34237083740234375,
          },
          gyroscope: {
            x: -0.041035222107958284,
            y: 0.0018652373685435584,
            z: -0.0058621745868511835,
          },
          temperature: 24.20058823529412,
          time: 1723317337.5147886,
        },
        {
          accelerometer: {
            x: 9.847351428222655,
            y: -0.01915361328125,
            z: 0.34237083740234375,
          },
          gyroscope: {
            x: -0.03863705977697371,
            y: -0.0013323124061025418,
            z: -0.0058621745868511835,
          },
          temperature: 24.15352941176471,
          time: 1723317338.3067205,
        },
        {
          accelerometer: {
            x: 9.854534033203125,
            y: -0.06464344482421874,
            z: 0.28969840087890625,
          },
          gyroscope: {
            x: -0.0401026034236865,
            y: 0.0013323124061025418,
            z: -0.006661562030512709,
          },
          temperature: 24.106470588235297,
          time: 1723317339.0815094,
        },
        {
          accelerometer: {
            x: 9.880870251464843,
            y: -0.05027823486328125,
            z: 0.44053310546874996,
          },
          gyroscope: {
            x: -0.03930321598002497,
            y: -0.0005329249624410166,
            z: -0.008793261880276773,
          },
          temperature: 24.20058823529412,
          time: 1723317339.8884945,
        },
        {
          accelerometer: {
            x: 9.87608184814453,
            y: -0.0718260498046875,
            z: 0.3016694091796875,
          },
          gyroscope: {
            x: -0.04036906590490701,
            y: 0.0035972434964768626,
            z: -0.0058621745868511835,
          },
          temperature: 24.15352941176471,
          time: 1723317340.6797364,
        },
        {
          accelerometer: {
            x: 9.85692823486328,
            y: -0.06943184814453125,
            z: 0.3184288208007812,
          },
          gyroscope: {
            x: -0.04036906590490701,
            y: 0,
            z: -0.0074609494741742334,
          },
          temperature: 24.20058823529412,
          time: 1723317341.4753242,
        },
        {
          accelerometer: {
            x: 9.904812268066406,
            y: -0.06464344482421874,
            z: 0.29927520751953124,
          },
          gyroscope: {
            x: -0.03877029101758396,
            y: -0.0006661562030512709,
            z: -0.006128637068071691,
          },
          temperature: 24.15352941176471,
          time: 1723317342.2739918,
        },
        {
          accelerometer: {
            x: 9.86411083984375,
            y: -0.07422025146484375,
            z: 0.2753331909179687,
          },
          gyroscope: {
            x: -0.03943644722063524,
            y: 0.0011990811654922875,
            z: -0.0058621745868511835,
          },
          temperature: 24.15352941176471,
          time: 1723317343.059634,
        },
        {
          accelerometer: {
            x: 9.854534033203125,
            y: -0.09816226806640624,
            z: 0.29448680419921874,
          },
          gyroscope: {
            x: -0.03956967846124549,
            y: 0.005196018383799912,
            z: -0.0063950995492922,
          },
          temperature: 24.24764705882353,
          time: 1723317343.8533015,
        },
        {
          accelerometer: {
            x: 9.90241806640625,
            y: -0.10295067138671875,
            z: 0.2346317626953125,
          },
          gyroscope: {
            x: -0.040901990867348026,
            y: 0.00159877488732305,
            z: -0.00159877488732305,
          },
          temperature: 24.24764705882353,
          time: 1723317344.6484504,
        },
        {
          accelerometer: {
            x: 9.892841259765625,
            y: -0.0909796630859375,
            z: 0.1867477294921875,
          },
          gyroscope: {
            x: -0.0415681470703993,
            y: 0.0013323124061025418,
            z: -0.0031975497746461,
          },
          temperature: 24.15352941176471,
          time: 1723317345.463003,
        },
        {
          accelerometer: {
            x: 9.854534033203125,
            y: -0.09816226806640624,
            z: 0.28012159423828126,
          },
          gyroscope: {
            x: -0.0401026034236865,
            y: 0.0031975497746461,
            z: -0.00479632466196915,
          },
          temperature: 24.20058823529412,
          time: 1723317346.2616866,
        },
        {
          accelerometer: {
            x: 9.868899243164062,
            y: -0.0526724365234375,
            z: 0.2609679809570312,
          },
          gyroscope: {
            x: -0.041967840792230066,
            y: 0.000799387443661525,
            z: -0.00479632466196915,
          },
          temperature: 24.15352941176471,
          time: 1723317347.0586352,
        },
        {
          accelerometer: {
            x: 9.832986218261718,
            y: -0.00239420166015625,
            z: 0.24181436767578124,
          },
          gyroscope: {
            x: -0.03850382853636345,
            y: 0.0018652373685435584,
            z: -0.006928024511733216,
          },
          temperature: 24.15352941176471,
          time: 1723317347.8261716,
        },
        {
          accelerometer: {
            x: 9.823409411621093,
            y: -0.0526724365234375,
            z: 0.296881005859375,
          },
          gyroscope: {
            x: -0.0401026034236865,
            y: -0.0006661562030512709,
            z: -0.0058621745868511835,
          },
          temperature: 24.24764705882353,
          time: 1723317348.63708,
        },
        {
          accelerometer: {
            x: 9.938331091308592,
            y: -0.0047884033203125,
            z: 0.3327940307617187,
          },
          gyroscope: {
            x: -0.0383705972957532,
            y: 0.0010658499248820332,
            z: -0.006928024511733216,
          },
          temperature: 24.15352941176471,
          time: 1723317349.415109,
        },
        {
          accelerometer: {
            x: 9.892841259765625,
            y: -0.08379705810546874,
            z: 0.2825157958984375,
          },
          gyroscope: {
            x: -0.041035222107958284,
            y: 0.002398162330984575,
            z: -0.007194486992953725,
          },
          temperature: 24.15352941176471,
          time: 1723317350.1870556,
        },
        {
          accelerometer: {
            x: 9.911994873046874,
            y: -0.076614453125,
            z: 0.36152445068359373,
          },
          gyroscope: {
            x: -0.0383705972957532,
            y: 0.002531393571594829,
            z: -0.008526799399056265,
          },
          temperature: 24.15352941176471,
          time: 1723317350.9522161,
        },
        {
          accelerometer: {
            x: 9.828197814941406,
            y: -0.08140285644531249,
            z: 0.34715924072265625,
          },
          gyroscope: {
            x: -0.04023583466429676,
            y: 0.0003996937218307625,
            z: -0.006128637068071691,
          },
          temperature: 24.106470588235297,
          time: 1723317351.7203813,
        },
        {
          accelerometer: {
            x: 9.866505041503906,
            y: -0.05027823486328125,
            z: 0.411802685546875,
          },
          gyroscope: {
            x: -0.03703828488965066,
            y: 0.0013323124061025418,
            z: -0.005595712105630674,
          },
          temperature: 24.20058823529412,
          time: 1723317352.485054,
        },
        {
          accelerometer: {
            x: 9.883264453125,
            y: -0.031124621582031248,
            z: 0.2753331909179687,
          },
          gyroscope: {
            x: -0.03930321598002497,
            y: 0.0006661562030512709,
            z: -0.004529862180748642,
          },
          temperature: 24.15352941176471,
          time: 1723317353.2505612,
        },
        {
          accelerometer: {
            x: 9.885658654785155,
            y: -0.09576806640624999,
            z: 0.316034619140625,
          },
          gyroscope: {
            x: -0.039969372183076245,
            y: 0.0014655436467127959,
            z: -0.0039969372183076245,
          },
          temperature: 24.24764705882353,
          time: 1723317354.0140917,
        },
        {
          accelerometer: {
            x: 9.904812268066406,
            y: -0.06703764648437499,
            z: 0.30406361083984373,
          },
          gyroscope: {
            x: -0.03850382853636345,
            y: 0.002264931090374321,
            z: -0.0031975497746461,
          },
          temperature: 24.20058823529412,
          time: 1723317354.7830162,
        },
        {
          accelerometer: {
            x: 9.880870251464843,
            y: -0.031124621582031248,
            z: 0.3112462158203125,
          },
          gyroscope: {
            x: -0.04063552838612752,
            y: 0.0033307810152563544,
            z: -0.003464012255866608,
          },
          temperature: 24.15352941176471,
          time: 1723317355.5457373,
        },
        {
          accelerometer: {
            x: 9.861716638183593,
            y: -0.09337386474609374,
            z: 0.3232172241210937,
          },
          gyroscope: {
            x: -0.03890352225819422,
            y: -0.0013323124061025418,
            z: -0.004263399699528133,
          },
          temperature: 24.15352941176471,
          time: 1723317356.311513,
        },
        {
          accelerometer: {
            x: 9.85692823486328,
            y: -0.047884033203124995,
            z: 0.3280056274414062,
          },
          gyroscope: {
            x: -0.0415681470703993,
            y: 0.0009326186842717792,
            z: -0.006128637068071691,
          },
          temperature: 24.20058823529412,
          time: 1723317357.0791595,
        },
        {
          accelerometer: {
            x: 9.907206469726562,
            y: -0.02633621826171875,
            z: 0.3016694091796875,
          },
          gyroscope: {
            x: -0.03810413481453269,
            y: 0.0013323124061025418,
            z: -0.00479632466196915,
          },
          temperature: 24.15352941176471,
          time: 1723317357.8486786,
        },
        {
          accelerometer: {
            x: 9.330203869628905,
            y: 1.0941501586914062,
            z: 1.2593500732421874,
          },
          gyroscope: {
            x: -0.8428208281004679,
            y: -0.023848392069235495,
            z: -0.04636447173236845,
          },
          temperature: 24.106470588235297,
          time: 1723317358.6100354,
        },
        {
          accelerometer: {
            x: 9.854534033203125,
            y: -0.055066638183593745,
            z: 0.20829554443359374,
          },
          gyroscope: {
            x: 0.3530627876171736,
            y: -0.002398162330984575,
            z: 0.02744563556571236,
          },
          temperature: 24.106470588235297,
          time: 1723317359.3697996,
        },
        {
          accelerometer: {
            x: 8.2743609375,
            y: -0.36152445068359373,
            z: 1.5298948608398437,
          },
          gyroscope: {
            x: -0.17999540606445338,
            y: 0.6999969381662754,
            z: -0.15774578888254095,
          },
          temperature: 24.341764705882355,
          time: 1723317360.1291285,
        },
        {
          accelerometer: {
            x: 7.915230688476562,
            y: 1.446097802734375,
            z: 2.7437551025390623,
          },
          gyroscope: {
            x: -1.6266202166105932,
            y: 0.07354364481686029,
            z: -1.5103093435578412,
          },
          temperature: 24.20058823529412,
          time: 1723317360.889359,
        },
        {
          accelerometer: {
            x: 6.394912634277343,
            y: -1.3575123413085937,
            z: -1.4245499877929686,
          },
          gyroscope: {
            x: -0.44192802510421303,
            y: -0.19891424223110948,
            z: -1.0250811652552956,
          },
          temperature: 24.341764705882355,
          time: 1723317361.664673,
        },
        {
          accelerometer: {
            x: 11.305420239257812,
            y: -3.5506010620117183,
            z: -1.0271125122070313,
          },
          gyroscope: {
            x: 1.4061225134006226,
            y: -0.4592480863835461,
            z: -0.21556814730739124,
          },
          temperature: 24.24764705882353,
          time: 1723317362.4322565,
        },
        {
          accelerometer: {
            x: 11.420341918945311,
            y: -0.2154781494140625,
            z: 5.925649108886718,
          },
          gyroscope: {
            x: 0.4700398168729767,
            y: 0.7965895876087096,
            z: 0.7967228188493198,
          },
          temperature: 24.24764705882353,
          time: 1723317363.1979632,
        },
        {
          accelerometer: {
            x: 4.496310717773437,
            y: 2.2601263671875,
            z: 5.76523759765625,
          },
          gyroscope: {
            x: -1.0988912725533764,
            y: -0.6492358354937685,
            z: 0.8108453303540069,
          },
          temperature: 24.20058823529412,
          time: 1723317363.9686027,
        },
        {
          accelerometer: {
            x: 9.868899243164062,
            y: -0.0047884033203125,
            z: 0.26336218261718747,
          },
          gyroscope: {
            x: 0.2290245026090269,
            y: 0.0014655436467127959,
            z: 0.01971822361031762,
          },
          temperature: 24.20058823529412,
          time: 1723317364.7374513,
        },
        {
          accelerometer: {
            x: 9.797073193359374,
            y: 0.028730419921875,
            z: 0.33758243408203126,
          },
          gyroscope: {
            x: -0.041301684589178794,
            y: 0.0019984686091538122,
            z: -0.005595712105630674,
          },
          temperature: 24.20058823529412,
          time: 1723317365.5066824,
        },
        {
          accelerometer: {
            x: 9.988609326171874,
            y: -0.031124621582031248,
            z: 0.3950432739257812,
          },
          gyroscope: {
            x: -0.03970290970185574,
            y: 0.0010658499248820332,
            z: -0.0058621745868511835,
          },
          temperature: 24.20058823529412,
          time: 1723317366.2720962,
        },
        {
          accelerometer: {
            x: 9.868899243164062,
            y: 0.031124621582031248,
            z: 0.3232172241210937,
          },
          gyroscope: {
            x: -0.06035375199644513,
            y: -0.0029310872934255917,
            z: -0.0058621745868511835,
          },
          temperature: 24.20058823529412,
          time: 1723317367.0561056,
        },
        {
          accelerometer: {
            x: 1.6807295654296874,
            y: -0.4836287353515625,
            z: 10.740388647460938,
          },
          gyroscope: {
            x: -1.0396033704818133,
            y: 1.9962036780634382,
            z: -0.544649311614719,
          },
          temperature: 24.24764705882353,
          time: 1723317367.8165076,
        },
        {
          accelerometer: {
            x: 3.284844677734375,
            y: 0.1197100830078125,
            z: 8.882488159179687,
          },
          gyroscope: {
            x: -0.009059724361497283,
            y: 0.1377611027910028,
            z: 0.11084839218773146,
          },
          temperature: 24.20058823529412,
          time: 1723317368.5764887,
        },
        {
          accelerometer: {
            x: 10.129867224121092,
            y: -0.1292868896484375,
            z: 3.5817256835937497,
          },
          gyroscope: {
            x: 0.06941347635794241,
            y: -3.0936294069701016,
            z: 0.05968759579339387,
          },
          temperature: 24.294705882352943,
          time: 1723317369.3430734,
        },
        {
          accelerometer: {
            x: 9.885658654785155,
            y: -0.0383072265625,
            z: 0.258573779296875,
          },
          gyroscope: {
            x: -0.04236753451406082,
            y: 0.004130168458917879,
            z: -0.004263399699528133,
          },
          temperature: 24.20058823529412,
          time: 1723317370.1015942,
        },
        {
          accelerometer: {
            x: 9.840168823242188,
            y: -0.023942016601562498,
            z: 0.3854664672851562,
          },
          gyroscope: {
            x: -0.0401026034236865,
            y: 0.002797856052815337,
            z: -0.006128637068071691,
          },
          temperature: 24.24764705882353,
          time: 1723317370.8727322,
        },
        {
          accelerometer: {
            x: 9.840168823242188,
            y: -0.023942016601562498,
            z: 0.35194764404296874,
          },
          gyroscope: {
            x: -0.03943644722063524,
            y: -0.0010658499248820332,
            z: -0.00159877488732305,
          },
          temperature: 24.24764705882353,
          time: 1723317371.638342,
        },
        {
          accelerometer: {
            x: 9.852139831542969,
            y: -0.0143652099609375,
            z: 0.29927520751953124,
          },
          gyroscope: {
            x: -0.03903675349880447,
            y: 0.003464012255866608,
            z: -0.006661562030512709,
          },
          temperature: 24.15352941176471,
          time: 1723317372.4022002,
        },
        {
          accelerometer: {
            x: 9.8449572265625,
            y: -0.0047884033203125,
            z: 0.3016694091796875,
          },
          gyroscope: {
            x: -0.041434915829789046,
            y: 0.0006661562030512709,
            z: -0.0039969372183076245,
          },
          temperature: 24.15352941176471,
          time: 1723317373.1702585,
        },
        {
          accelerometer: {
            x: 9.878476049804688,
            y: 0.04548983154296875,
            z: 0.34715924072265625,
          },
          gyroscope: {
            x: -0.040502297145517265,
            y: -0.001732006127933304,
            z: -0.0031975497746461,
          },
          temperature: 24.24764705882353,
          time: 1723317373.9384649,
        },
        {
          accelerometer: {
            x: 9.86411083984375,
            y: 0,
            z: 0.26815058593749996,
          },
          gyroscope: {
            x: -0.041035222107958284,
            y: 0.002797856052815337,
            z: -0.007993874436615249,
          },
          temperature: 24.24764705882353,
          time: 1723317374.7046237,
        },
        {
          accelerometer: {
            x: 9.904812268066406,
            y: -0.05985504150390625,
            z: 0.3136404174804687,
          },
          gyroscope: {
            x: -0.04210107203284032,
            y: 0.005595712105630674,
            z: -0.005062787143189658,
          },
          temperature: 24.24764705882353,
          time: 1723317375.4737089,
        },
        {
          accelerometer: {
            x: 9.904812268066406,
            y: -0.0909796630859375,
            z: 0.316034619140625,
          },
          gyroscope: {
            x: -0.03930321598002497,
            y: 0.001732006127933304,
            z: -0.006128637068071691,
          },
          temperature: 24.24764705882353,
          time: 1723317376.2363446,
        },
        {
          accelerometer: {
            x: 9.852139831542969,
            y: -0.047884033203124995,
            z: 0.2657563842773437,
          },
          gyroscope: {
            x: -0.03757120985209167,
            y: 0.0003996937218307625,
            z: -0.005595712105630674,
          },
          temperature: 24.106470588235297,
          time: 1723317377.0220888,
        },
        {
          accelerometer: {
            x: 9.811438403320311,
            y: -0.07900865478515624,
            z: 0.2657563842773437,
          },
          gyroscope: {
            x: -0.04223430327345057,
            y: 0.002398162330984575,
            z: -0.004529862180748642,
          },
          temperature: 24.624117647058824,
          time: 1723323822.4467866,
        },
      ];

      const motion = new MotionCalculator();

      // Grafikleri oluştur
      const charts = {
        velocity: new Chart(
          document.getElementById("velocityChart").getContext("2d"),
          {
            type: "line",
            data: {
              labels: [],
              datasets: [
                { label: "X", data: [], borderColor: "red" },
                { label: "Y", data: [], borderColor: "green" },
                { label: "Z", data: [], borderColor: "blue" },
              ],
            },
            options: { title: { display: true, text: "Velocity" } },
          }
        ),
        position: new Chart(
          document.getElementById("positionChart").getContext("2d"),
          {
            type: "line",
            data: {
              labels: [],
              datasets: [
                { label: "X", data: [], borderColor: "red" },
                { label: "Y", data: [], borderColor: "green" },
                { label: "Z", data: [], borderColor: "blue" },
              ],
            },
            options: { title: { display: true, text: "Position" } },
          }
        ),
        orientation: new Chart(
          document.getElementById("orientationChart").getContext("2d"),
          {
            type: "line",
            data: {
              labels: [],
              datasets: [
                { label: "Pitch", data: [], borderColor: "red" },
                { label: "Yaw", data: [], borderColor: "green" },
                { label: "Roll", data: [], borderColor: "blue" },
              ],
            },
            options: { title: { display: true, text: "Orientation" } },
          }
        ),
        acceleration: new Chart(
          document.getElementById("accelerationChart").getContext("2d"),
          {
            type: "line",
            data: {
              labels: [],
              datasets: [
                { label: "X", data: [], borderColor: "red" },
                { label: "Y", data: [], borderColor: "green" },
                { label: "Z", data: [], borderColor: "blue" },
              ],
            },
            options: { title: { display: true, text: "Acceleration" } },
          }
        ),
      };

      function updateCharts(result) {
        if (!result) {
          return;
        }
        const timestamp = new Date().toLocaleTimeString();

        Object.keys(charts).forEach((key) => {
          const chart = charts[key];
          chart.data.labels.push(timestamp);

          Object.keys(result[key]).forEach((axis, index) => {
            chart.data.datasets[index].data.push(result[key][axis]);
          });

          if (chart.data.labels.length > 50) {
            chart.data.labels.shift();
            chart.data.datasets.forEach((dataset) => dataset.data.shift());
          }

          chart.update();
        });
      }

      function processDataWithInterval(dataArray, index = 0) {
        if (index >= dataArray.length) {
          console.log("Tüm veriler işlendi.");
          return;
        }

        const item = dataArray[index];
        const result = motion.update(item.accelerometer, item.gyroscope);
        console.log(result);
        updateCharts(result);

        setTimeout(() => processDataWithInterval(dataArray, index + 1), 700);
      }

      processDataWithInterval(data);
    </script>
  </body>
</html>
